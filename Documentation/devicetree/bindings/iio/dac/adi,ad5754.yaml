# SPDX-License-Identifier: (GPL-2.0 OR BSD-2-Clause)
%YAML 1.2
---
$id: http://devicetree.org/schemas/iio/dac/adi,ad5754.yaml#
$schema: http://devicetree.org/meta-schemas/core.yaml#

title: Analog Devices AD5754 DAC device driver

maintainers:
  - Ciprian Regus <ciprian.regus@analog.com>

description: |
  The AD5754 and the other chip variants are dual/quad, 12-/14-/16-bit serial input,
  voltage output, digital-to-analog converters (DACs).

  https://www.analog.com/media/en/technical-documentation/data-sheets/AD5724_5734_5754.pdf
  https://www.analog.com/media/en/technical-documentation/data-sheets/ad5722_5732_5752.pdf
  https://www.analog.com/media/en/technical-documentation/data-sheets/ad5724r_5734r_5754r.pdf
  https://www.analog.com/media/en/technical-documentation/data-sheets/AD5722R_5732R_5752R.pdf

allOf:
  - $ref: /schemas/spi/spi-peripheral-props.yaml#

properties:
  compatible:
    enum:
      - adi,ad5754
      - adi,ad5734
      - adi,ad5724
      - adi,ad5752
      - adi,ad5732
      - adi,ad5722
      - adi,ad5754r
      - adi,ad5734r
      - adi,ad5724r
      - adi,ad5752r
      - adi,ad5732r
      - adi,ad5722r

  reg:
    maxItems: 1

  spi-max-frequency:
    maximum: 30000000

  spi-cpol: true

  vref-supply:
    description:
      The regulator to use as an external reference. If this is not provided,
      the internal reference will be used for chips that have this feature.
      The external reference must be 2.5V.

  '#address-cells':
    const: 1

  '#size-cells':
    const: 0

patternProperties:
  "^channel@([0-3])$":
    type: object
    description: Configurations for the DAC channels

    additionalProperties: false

    properties:
      reg:
        description: Channel number
        enum: [0, 1, 2, 3]

      output-range-microvolts:
        description: |
          Voltage range of a channel as <minimum, maximum>.

        oneOf:
          - items:
              - const: 0
              - enum: [5000000, 10000000, 10800000]
          - items:
              - const: -5000000
              - const: 5000000
          - items:
              - const: -10000000
              - const: 10000000
          - items:
              - const: -10800000
              - const: 10800000

required:
  - compatible
  - reg
  - spi-max-frequency
  - spi-cpol
  - output-range-microvolts

additionalProperties: false

examples:
  - |
    spi {
          status = "okay";

          #address-cells = <1>;
          #size-cells = <0>;

          dac@0 {
              compatible = "adi,ad5754r";
              reg = <0>;
              spi-max-frequency = <1000000>;
              spi-cpol;

              #address-cells = <1>;
              #size-cells = <0>;

              channel@0 {
                  reg = <0>;
                  output-range-microvolts = <(-5000000) 5000000>;
              };
              channel@1 {
                  reg = <1>;
                  output-range-microvolts = <(-5000000) 5000000>;
              };
              channel@2 {
                  reg = <2>;
                  output-range-microvolts = <(-5000000) 5000000>;
              };
              channel@3 {
                  reg = <3>;
                  output-range-microvolts = <(-5000000) 5000000>;
              };
          };
      };
