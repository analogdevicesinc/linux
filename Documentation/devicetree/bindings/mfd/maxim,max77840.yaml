# SPDX-License-Identifier: GPL-2.0-only
%YAML 1.2
---
$id: http://devicetree.org/schemas/mfd/maxim,max77840.yaml#
$schema: http://devicetree.org/meta-schemas/core.yaml#

title: Maxim MAX77840 PMIC

maintainers:
  - Joan Na <joan.na@analog.com>


properties:
  compatible:
    const: maxim,max77840

  reg:
    maxItems: 1

  interrupts:
    maxItems: 1

  interrupt-controller: true

patternProperties:
  "^regulator(@.*)?$":
    type: object
    additionalProperties: true

  "^charger(@.*)?$":
    type: object
    $ref: /schemas/power/supply/maxim,max77840-charger.yaml#

  "^fuelgauge(@.*)?$":
    type: object
    $ref: /schemas/power/supply/maxim,max77840-fuelgauge.yaml#

  "^charger-detect(@.*)?$":
    type: object
    properties:
      compatible:
        const: maxim,max77840-charger-detect

    additionalProperties: false

required:
  - compatible
  - reg
  - interrupt-parent
  - interrupts
  - interrupt-controller

additionalProperties: false

examples:
  - |
    #include <dt-bindings/interrupt-controller/irq.h>

    i2c@0 {
      #address-cells = <1>;
      #size-cells = <0>;

      max77840@66 {
        compatible = "maxim,max77840";
        reg = <0x66>;
        interrupt-parent = <&gpio>;
        interrupts = <16 IRQ_TYPE_LEVEL_LOW>;
        interrupt-controller;
        #interrupt-cells = <1>;
        status = "okay";

        regulator {
          SAFEOUT1 {
            regulator-boot-on;
            regulator-always-on;
          };
        };

        charger {
          compatible = "maxim,max77840-charger";
          status = "disabled";
          fast_charge_timer = <0>;                  // disable
          fast_charge_current = <1500>;             // mA
          charge_termination_voltage = <4350>;      // mV
          topoff_timer = <30>;                      // min
          topoff_current = <150>;                   // mA
          restart_threshold = <150>;                // mV
          input_current_limit = <500>;              // mA
        };

        charger-detect {
          compatible = "maxim,max77840-charger-detect";
          status = "disabled";
        };

        fuelgauge {
          compatible = "maxim,max77840-fuelgauge";
          fuelgauge,fuel_alert_soc = <2>;
        };
      };
    };
