<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />
<meta content="ADC driver for Analog Devices Inc. AD4695 and similar devices. The module name is ad4695." name="description" />

    <title>AD4695 driver &#8212; Linux Drivers  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8e8a900e" />
    <link rel="stylesheet" type="text/css" href="../_static/app.min.css?v=8d0b0339" />
    <script async="async" src="../_static/app.umd.js?v=2f9373fc"></script>
    <link rel="icon" href="../_static/icon.svg"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="AD7191 driver" href="ad7191.html" />
    <link rel="prev" title="AD4000 driver" href="ad4000.html" />
   
  
  
  <meta name="repository" content="linux">
  <meta name="version" content="">
  
    <meta name="page_source_suffix" content=".rst">
  
  
  


<style>
  body {
    
  }

  body.dark {
    
  }

  @media (prefers-color-scheme: dark) {
    body:not(.light) {
      
    }
  }
</style>
  </head><body>
  <input type="checkbox" id="input-show-toc">
  <input type="checkbox" id="input-show-localtoc">
  <input type="checkbox" id="input-show-repotoc">

  
  <div class="search-area">
    <form action="" method="get">
      <input type="text" name="q" aria-labelledby="search-documentation" value="" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" role="search" placeholder="Search"/>
      <button class="icon"></button>
    </form>
  </div>
  

  <header>
    <div id="left">
      <label id="show-sidebar" class="icon" for="input-show-toc" title="Show/hide index"></label>
    </div>
    <div id="right">
      <span>
        <a id="logo-org" href="https://analog.com" aria-label="Analog Devices Inc. landing page"></a>
        <div class="vertical-divider"></div>
        
        <label id="show-repotoc" for="input-show-repotoc" title="Show/hide docs" tabindex="0">Docs</label>
        
        <a id="logo" href="../index.html">
          <div>Linux</div>
        </a>
      </span>
      <span class="reverse">
        <label id="show-localtoc" class="icon" for="input-show-localtoc" title="Show/hide contents"></label>
      </span>
    </div>
  </header>


  <div class="repotoc-tree overlay">
    <root>
  <a href="../index.html" class="current">Linux</a>
</root>

  </div>
    <div class="localtoc">
      <div class="tocwrapper">
        <div class="header localtoc-header">
          <a id="scroll-up" href="#top-anchor" title="Back to top"></a>
        </div>
        <nav>
          <ul>
<li><a class="reference internal" href="#">AD4695 driver</a><ul>
<li><a class="reference internal" href="#supported-devices">Supported devices</a></li>
<li><a class="reference internal" href="#supported-features">Supported features</a><ul>
<li><a class="reference internal" href="#spi-wiring-modes">SPI wiring modes</a><ul>
<li><a class="reference internal" href="#wire-mode">4-wire mode</a></li>
<li><a class="reference internal" href="#spi-offload-wiring">SPI offload wiring</a></li>
</ul>
</li>
<li><a class="reference internal" href="#channel-configuration">Channel configuration</a><ul>
<li><a class="reference internal" href="#pairing-with-refgnd">Pairing with REFGND</a></li>
<li><a class="reference internal" href="#pairing-with-com">Pairing with COM</a></li>
<li><a class="reference internal" href="#pairing-two-inx-pins">Pairing two INx pins</a></li>
</ul>
</li>
<li><a class="reference internal" href="#vcc-supply">VCC supply</a></li>
<li><a class="reference internal" href="#reference-voltage">Reference voltage</a></li>
<li><a class="reference internal" href="#gain-offset-calibration">Gain/offset calibration</a></li>
<li><a class="reference internal" href="#oversampling">Oversampling</a></li>
<li><a class="reference internal" href="#unimplemented-features">Unimplemented features</a></li>
</ul>
</li>
<li><a class="reference internal" href="#spi-offload-support">SPI offload support</a></li>
<li><a class="reference internal" href="#device-buffers">Device buffers</a><ul>
<li><a class="reference internal" href="#effective-sample-rate-for-buffered-reads">Effective sample rate for buffered reads</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </nav>
      </div>
    </div>

  
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
    <a id="no-logo" href="../index.html">
      Linux Drivers
    </a><input id="input-switch-toc" type="checkbox">
<label id="show-repotoc" for="input-switch-toc">
All content
</label>
<label id="show-toc" for="input-switch-toc">
Content on this topic
</label>
<div class="repotoc-tree">
  <root>
  <a href="../index.html" class="current">Linux</a>
</root>

</div>
<div class="toc-tree">
  <html>
  <body><ul class="current">
<li class="toctree-l1 current"><input class="toctree-collapse" type="checkbox" name="toctree-collapse-1" id="toctree-collapse-1" checked=""/><div class="collapse"><a class="reference internal" href="index.html">Industrial I/O</a><label for="toctree-collapse-1"><div class="icon"></div></label></div><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="iio_devbuf.html">Industrial IIO device buffers</a></li>
<li class="toctree-l2"><a class="reference internal" href="ad3552r.html">AD3552R driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="ad4000.html">AD4000 driver</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">AD4695 driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="ad7191.html">AD7191 driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="ad7380.html">AD7380 driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="ad7625.html">AD7625 driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="ad7944.html">AD7944 driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="adis16475.html">ADIS16475 driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="adis16480.html">ADIS16480 driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="adis16550.html">ADIS16550 driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="adxl380.html">ADXL380 driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="apollo.html">AD9088 driver</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../ci.html">Continuous integration</a></li>
</ul>
</body>
</html>

</div>
        </div>
      </div>

  <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper" id="top-anchor">
          <div class="body-header">
  <nav class="breadcrumb"><ol><li><a href="index.html">Industrial I/O</a></li></ol></nav>
</div>
          <div class="body" role="main">
            
  <section id="ad4695-driver">
<h1>AD4695 driver<a class="headerlink" href="#ad4695-driver" title="Link to this heading"></a></h1>
<p>ADC driver for Analog Devices Inc. AD4695 and similar devices. The module name
is <code class="docutils literal notranslate"><span class="pre">ad4695</span></code>.</p>
<section id="supported-devices">
<h2>Supported devices<a class="headerlink" href="#supported-devices" title="Link to this heading"></a></h2>
<p>The following chips are supported by this driver:</p>
<ul class="simple">
<li><p><a class="icon link reference external" href="https://www.analog.com/AD4695" target="_blank">AD4695</a></p></li>
<li><p><a class="icon link reference external" href="https://www.analog.com/AD4696" target="_blank">AD4696</a></p></li>
<li><p><a class="icon link reference external" href="https://www.analog.com/AD4697" target="_blank">AD4697</a></p></li>
<li><p><a class="icon link reference external" href="https://www.analog.com/AD4698" target="_blank">AD4698</a></p></li>
</ul>
</section>
<section id="supported-features">
<h2>Supported features<a class="headerlink" href="#supported-features" title="Link to this heading"></a></h2>
<section id="spi-wiring-modes">
<h3>SPI wiring modes<a class="headerlink" href="#spi-wiring-modes" title="Link to this heading"></a></h3>
<p>The driver currently supports the following SPI wiring configuration:</p>
<section id="wire-mode">
<h4>4-wire mode<a class="headerlink" href="#wire-mode" title="Link to this heading"></a></h4>
<p>In this mode, CNV and CS are tied together and there is a single SDO line.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">+-------------+</span>         <span class="o">+-------------+</span>
<span class="o">|</span>          <span class="n">CS</span> <span class="o">|&lt;-+------|</span> <span class="n">CS</span>          <span class="o">|</span>
<span class="o">|</span>         <span class="n">CNV</span> <span class="o">|&lt;-+</span>      <span class="o">|</span>             <span class="o">|</span>
<span class="o">|</span>     <span class="n">ADC</span>     <span class="o">|</span>         <span class="o">|</span>     <span class="n">HOST</span>    <span class="o">|</span>
<span class="o">|</span>             <span class="o">|</span>         <span class="o">|</span>             <span class="o">|</span>
<span class="o">|</span>         <span class="n">SDI</span> <span class="o">|&lt;--------|</span> <span class="n">SDO</span>         <span class="o">|</span>
<span class="o">|</span>         <span class="n">SDO</span> <span class="o">|--------&gt;|</span> <span class="n">SDI</span>         <span class="o">|</span>
<span class="o">|</span>        <span class="n">SCLK</span> <span class="o">|&lt;--------|</span> <span class="n">SCLK</span>        <span class="o">|</span>
<span class="o">+-------------+</span>         <span class="o">+-------------+</span>
</pre></div>
</div>
<p>To use this mode, in the device tree, omit the <code class="docutils literal notranslate"><span class="pre">cnv-gpios</span></code> and
<code class="docutils literal notranslate"><span class="pre">spi-rx-bus-width</span></code> properties.</p>
</section>
<section id="spi-offload-wiring">
<h4>SPI offload wiring<a class="headerlink" href="#spi-offload-wiring" title="Link to this heading"></a></h4>
<p>When used with a SPI offload, the supported wiring configuration is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">+-------------+</span>         <span class="o">+-------------+</span>
<span class="o">|</span>    <span class="n">GP0</span><span class="o">/</span><span class="n">BUSY</span> <span class="o">|--------&gt;|</span> <span class="n">TRIGGER</span>     <span class="o">|</span>
<span class="o">|</span>          <span class="n">CS</span> <span class="o">|&lt;--------|</span> <span class="n">CS</span>          <span class="o">|</span>
<span class="o">|</span>             <span class="o">|</span>         <span class="o">|</span>             <span class="o">|</span>
<span class="o">|</span>     <span class="n">ADC</span>     <span class="o">|</span>         <span class="o">|</span>     <span class="n">SPI</span>     <span class="o">|</span>
<span class="o">|</span>             <span class="o">|</span>         <span class="o">|</span>             <span class="o">|</span>
<span class="o">|</span>         <span class="n">SDI</span> <span class="o">|&lt;--------|</span> <span class="n">SDO</span>         <span class="o">|</span>
<span class="o">|</span>         <span class="n">SDO</span> <span class="o">|--------&gt;|</span> <span class="n">SDI</span>         <span class="o">|</span>
<span class="o">|</span>        <span class="n">SCLK</span> <span class="o">|&lt;--------|</span> <span class="n">SCLK</span>        <span class="o">|</span>
<span class="o">|</span>             <span class="o">|</span>         <span class="o">|</span>             <span class="o">|</span>
<span class="o">|</span>             <span class="o">|</span>         <span class="o">+-------------+</span>
<span class="o">|</span>         <span class="n">CNV</span> <span class="o">|&lt;-----+--|</span> <span class="n">PWM</span>         <span class="o">|</span>
<span class="o">|</span>             <span class="o">|</span>      <span class="o">+--|</span> <span class="n">GPIO</span>        <span class="o">|</span>
<span class="o">+-------------+</span>         <span class="o">+-------------+</span>
</pre></div>
</div>
<p>In this case, both the <code class="docutils literal notranslate"><span class="pre">cnv-gpios</span></code> and  <code class="docutils literal notranslate"><span class="pre">pwms</span></code> properties are required.
The <code class="docutils literal notranslate"><span class="pre">#trigger-source-cells</span> <span class="pre">=</span> <span class="pre">&lt;2&gt;</span></code> property is also required to connect back
to the SPI offload. The SPI offload will have <code class="docutils literal notranslate"><span class="pre">trigger-sources</span></code> property
with cells to indicate the busy signal and which GPx pin is used, e.g
<code class="docutils literal notranslate"><span class="pre">&lt;&amp;ad4695</span> <span class="pre">AD4695_TRIGGER_EVENT_BUSY</span> <span class="pre">AD4695_TRIGGER_PIN_GP0&gt;</span></code>.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#spi-offload-support">SPI offload support</a></p>
</div>
</section>
</section>
<section id="channel-configuration">
<h3>Channel configuration<a class="headerlink" href="#channel-configuration" title="Link to this heading"></a></h3>
<p>Since the chip supports multiple ways to configure each channel, this must be
described in the device tree based on what is actually wired up to the inputs.</p>
<p>There are three typical configurations:</p>
<p>An <code class="docutils literal notranslate"><span class="pre">INx</span></code> pin is used as the positive input with the <code class="docutils literal notranslate"><span class="pre">REFGND</span></code>, <code class="docutils literal notranslate"><span class="pre">COM</span></code> or
the next <code class="docutils literal notranslate"><span class="pre">INx</span></code> pin as the negative input.</p>
<section id="pairing-with-refgnd">
<h4>Pairing with REFGND<a class="headerlink" href="#pairing-with-refgnd" title="Link to this heading"></a></h4>
<p>Each <code class="docutils literal notranslate"><span class="pre">INx</span></code> pin can be used as a pseudo-differential input in conjunction with
the <code class="docutils literal notranslate"><span class="pre">REFGND</span></code> pin. The device tree will look like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">channel</span><span class="o">@</span><span class="mi">0</span> <span class="p">{</span>
    <span class="n">reg</span> <span class="o">=</span> <span class="o">&lt;</span><span class="mi">0</span><span class="o">&gt;</span><span class="p">;</span> <span class="o">/*</span> <span class="n">IN0</span> <span class="o">*/</span>
<span class="p">};</span>
</pre></div>
</div>
<p>If no other channel properties are needed (e.g. <code class="docutils literal notranslate"><span class="pre">adi,no-high-z</span></code>), the channel
node can be omitted entirely.</p>
<p>This will appear on the IIO bus as the <code class="docutils literal notranslate"><span class="pre">voltage0</span></code> channel. The processed value
(<em>raw × scale</em>) will be the voltage present on the <code class="docutils literal notranslate"><span class="pre">IN0</span></code> pin relative to
<code class="docutils literal notranslate"><span class="pre">REFGND</span></code>. (Offset is always 0 when pairing with <code class="docutils literal notranslate"><span class="pre">REFGND</span></code>.)</p>
</section>
<section id="pairing-with-com">
<h4>Pairing with COM<a class="headerlink" href="#pairing-with-com" title="Link to this heading"></a></h4>
<p>Each <code class="docutils literal notranslate"><span class="pre">INx</span></code> pin can be used as a pseudo-differential input in conjunction with
the <code class="docutils literal notranslate"><span class="pre">COM</span></code> pin. The device tree will look like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">com</span><span class="o">-</span><span class="n">supply</span> <span class="o">=</span> <span class="o">&lt;&amp;</span><span class="n">vref_div_2</span><span class="o">&gt;</span><span class="p">;</span>

<span class="n">channel</span><span class="o">@</span><span class="mi">1</span> <span class="p">{</span>
    <span class="n">reg</span> <span class="o">=</span> <span class="o">&lt;</span><span class="mi">1</span><span class="o">&gt;</span><span class="p">;</span> <span class="o">/*</span> <span class="n">IN1</span> <span class="o">*/</span>
    <span class="n">common</span><span class="o">-</span><span class="n">mode</span><span class="o">-</span><span class="n">channel</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">AD4695_COMMON_MODE_COM</span><span class="o">&gt;</span><span class="p">;</span>
    <span class="n">bipolar</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</div>
<p>This will appear on the IIO bus as the <code class="docutils literal notranslate"><span class="pre">voltage1</span></code> channel. The processed value
(<em>(raw + offset) × scale</em>) will be the voltage measured on the <code class="docutils literal notranslate"><span class="pre">IN1</span></code> pin
relative to <code class="docutils literal notranslate"><span class="pre">REFGND</span></code>. (The offset is determined by the <code class="docutils literal notranslate"><span class="pre">com-supply</span></code> voltage.)</p>
<p>The macro comes from:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#include &lt;dt-bindings/iio/adc/adi,ad4695.h&gt;</span>
</pre></div>
</div>
</section>
<section id="pairing-two-inx-pins">
<h4>Pairing two INx pins<a class="headerlink" href="#pairing-two-inx-pins" title="Link to this heading"></a></h4>
<p>An even-numbered <code class="docutils literal notranslate"><span class="pre">INx</span></code> pin and the following odd-numbered <code class="docutils literal notranslate"><span class="pre">INx</span></code> pin can be
used as a pseudo-differential input. The device tree for using <code class="docutils literal notranslate"><span class="pre">IN2</span></code> as the
positive input and <code class="docutils literal notranslate"><span class="pre">IN3</span></code> as the negative input will look like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">in3</span><span class="o">-</span><span class="n">supply</span> <span class="o">=</span> <span class="o">&lt;&amp;</span><span class="n">vref_div_2</span><span class="o">&gt;</span><span class="p">;</span>

<span class="n">channel</span><span class="o">@</span><span class="mi">2</span> <span class="p">{</span>
    <span class="n">reg</span> <span class="o">=</span> <span class="o">&lt;</span><span class="mi">2</span><span class="o">&gt;</span><span class="p">;</span> <span class="o">/*</span> <span class="n">IN2</span> <span class="o">*/</span>
    <span class="n">common</span><span class="o">-</span><span class="n">mode</span><span class="o">-</span><span class="n">channel</span> <span class="o">=</span> <span class="o">&lt;</span><span class="mi">3</span><span class="o">&gt;</span><span class="p">;</span> <span class="o">/*</span> <span class="n">IN3</span> <span class="o">*/</span>
    <span class="n">bipolar</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</div>
<p>This will appear on the IIO bus as the <code class="docutils literal notranslate"><span class="pre">voltage2</span></code> channel. The processed value
(<em>(raw + offset) × scale</em>) will be the voltage measured on the <code class="docutils literal notranslate"><span class="pre">IN1</span></code> pin
relative to <code class="docutils literal notranslate"><span class="pre">REFGND</span></code>. (Offset is determined by the <code class="docutils literal notranslate"><span class="pre">in3-supply</span></code> voltage.)</p>
</section>
</section>
<section id="vcc-supply">
<h3>VCC supply<a class="headerlink" href="#vcc-supply" title="Link to this heading"></a></h3>
<p>The chip supports being powered by an external LDO via the <code class="docutils literal notranslate"><span class="pre">VCC</span></code> input or an
internal LDO via the <code class="docutils literal notranslate"><span class="pre">LDO_IN</span></code> input. The driver looks at the device tree to
determine which is being used. If <code class="docutils literal notranslate"><span class="pre">ldo-supply</span></code> is present, then the internal
LDO is used. If <code class="docutils literal notranslate"><span class="pre">vcc-supply</span></code> is present, then the external LDO is used and
the internal LDO is disabled.</p>
</section>
<section id="reference-voltage">
<h3>Reference voltage<a class="headerlink" href="#reference-voltage" title="Link to this heading"></a></h3>
<p>The chip supports an external reference voltage via the <code class="docutils literal notranslate"><span class="pre">REF</span></code> input or an
internal buffered reference voltage via the <code class="docutils literal notranslate"><span class="pre">REFIN</span></code> input. The driver looks
at the device tree to determine which is being used. If <code class="docutils literal notranslate"><span class="pre">ref-supply</span></code> is
present, then the external reference voltage is used and the internal buffer is
disabled. If <code class="docutils literal notranslate"><span class="pre">refin-supply</span></code> is present, then the internal buffered reference
voltage is used.</p>
</section>
<section id="gain-offset-calibration">
<h3>Gain/offset calibration<a class="headerlink" href="#gain-offset-calibration" title="Link to this heading"></a></h3>
<p>System calibration is supported using the channel gain and offset registers via
the <code class="docutils literal notranslate"><span class="pre">calibscale</span></code> and <code class="docutils literal notranslate"><span class="pre">calibbias</span></code> attributes respectively.</p>
</section>
<section id="oversampling">
<h3>Oversampling<a class="headerlink" href="#oversampling" title="Link to this heading"></a></h3>
<p>The chip supports per-channel oversampling when SPI offload is being used, with
available oversampling ratios (OSR) of 1 (default), 4, 16, and 64.  Enabling
oversampling on a channel raises the effective number of bits of sampled data to
17 (OSR == 4), 18 (16), or 19 (64), respectively. This can be set via the
<code class="docutils literal notranslate"><span class="pre">oversampling_ratio</span></code> attribute.</p>
<p>Setting the oversampling ratio for a channel also changes the sample rate for
that channel, since it requires multiple conversions per 1 sample. Specifically,
the new sampling frequency is the PWM sampling frequency divided by the
particular OSR. This is set automatically by the driver when setting the
<code class="docutils literal notranslate"><span class="pre">oversampling_ratio</span></code> attribute. For example, if the device’s current
<code class="docutils literal notranslate"><span class="pre">sampling_frequency</span></code> is 10000 and an OSR of 4 is set on channel <code class="docutils literal notranslate"><span class="pre">voltage0</span></code>,
the new reported sampling rate for that channel will be 2500 (ignoring PWM API
rounding), while all others will remain at 10000.  Subsequently setting the
sampling frequency to a higher value on that channel will adjust the CNV trigger
period for all channels, e.g. if <code class="docutils literal notranslate"><span class="pre">voltage0</span></code>’s sampling frequency is adjusted
from 2500 (with an OSR of 4) to 10000, the value reported by
<code class="docutils literal notranslate"><span class="pre">in_voltage0_sampling_frequency</span></code> will be 10000, but all other channels will
now report 40000.</p>
<p>For simplicity, the sampling frequency of the device should be set (considering
the highest desired OSR value to be used) first, before configuring oversampling
for specific channels.</p>
</section>
<section id="unimplemented-features">
<h3>Unimplemented features<a class="headerlink" href="#unimplemented-features" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Additional wiring modes</p></li>
<li><p>Threshold events</p></li>
<li><p>GPIO support</p></li>
<li><p>CRC support</p></li>
</ul>
</section>
</section>
<section id="spi-offload-support">
<h2>SPI offload support<a class="headerlink" href="#spi-offload-support" title="Link to this heading"></a></h2>
<p>To be able to achieve the maximum sample rate, the driver can be used with the
<a class="icon link reference external" href="http://analogdevicesinc.github.io/hdl/projects/ad469x_fmc/index.html" target="_blank">AXI SPI Engine</a> to provide SPI offload support.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#spi-offload-wiring">SPI offload wiring</a></p>
</div>
<p>When SPI offload is being used, some attributes will be different.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">trigger</span></code> directory is removed.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">in_voltage0_sampling_frequency</span></code> attributes are added for setting the sample
rate.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">in_voltage0_sampling_frequency_available</span></code> attributes are added for querying
the max sample rate.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">timestamp</span></code> channel is removed.</p></li>
<li><p>Buffer data format may be different compared to when offload is not used,
e.g. the <code class="docutils literal notranslate"><span class="pre">buffer0/in_voltage0_type</span></code> attribute.</p></li>
</ul>
</section>
<section id="device-buffers">
<h2>Device buffers<a class="headerlink" href="#device-buffers" title="Link to this heading"></a></h2>
<p>This driver supports hardware triggered buffers. This uses the “advanced
sequencer” feature of the chip to trigger a burst of conversions.</p>
<p>Also see <a class="reference internal" href="iio_devbuf.html"><span class="doc">Industrial IIO device buffers</span></a> for more general information.</p>
<section id="effective-sample-rate-for-buffered-reads">
<h3>Effective sample rate for buffered reads<a class="headerlink" href="#effective-sample-rate-for-buffered-reads" title="Link to this heading"></a></h3>
<p>When SPI offload is not used, the sample rate is determined by the trigger that
is manually configured in userspace. All enabled channels will be read in a
burst when the trigger is received.</p>
<p>When SPI offload is used, the sample rate is configured per channel. All
channels will have the same rate, so only one <code class="docutils literal notranslate"><span class="pre">in_voltageY_sampling_frequency</span></code>
attribute needs to be set. Since this rate determines the delay between each
individual conversion, the effective sample rate for each sample is actually
the sum of the periods of each enabled channel in a buffered read. In other
words, it is the value of the <code class="docutils literal notranslate"><span class="pre">in_voltageY_sampling_frequency</span></code> attribute
divided by the number of enabled channels. So if 4 channels are enabled, with
the <code class="docutils literal notranslate"><span class="pre">in_voltageY_sampling_frequency</span></code> attributes set to 1 MHz, the effective
sample rate is 250 kHz.</p>
<p>With oversampling enabled, the effective sample rate also depends on the OSR
assigned to each channel. For example, if one of the 4 channels mentioned in the
previous case is configured with an OSR of 4, the effective sample rate for that
channel becomes (1 MHz / 4 ) = 250 kHz. The effective sample rate for all
four channels is then 1 / ( (3 / 1 MHz) + ( 1 / 250 kHz) ) ~= 142.9 kHz. Note
that in this case “sample” refers to one read of all enabled channels (i.e. one
full cycle through the auto-sequencer).</p>
</section>
</section>
</section>


          </div>
              <div class="related">
                &nbsp;
    <a href="ad4000.html" title="Previous document (Alt+Shift+LeftArrow)" class="prev">AD4000 driver</a>
    <a href="ad7191.html" title="Next document (Alt+Shift+RightArrow)" class="next">AD7191 driver</a>
              </div>
          
        </div>
      </div>
  </div>

  <label id="cancel-area-show-toc" for="input-show-toc"></label>
  <label id="cancel-area-show-localtoc" for="input-show-localtoc"></label>
    <footer>
      &#169;2025, Analog Devices, Inc.
      
      |
      Made with <a href="https://www.sphinx-doc.org/">Sphinx</a>
      &amp; <a href="https://github.com/analogdevicesinc/doctools">Doctools</a>
      
    </footer>
  </body>
</html>