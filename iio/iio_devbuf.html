<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />
<meta content="The Industrial I/O core offers a way for continuous data capture based on a trigger source. Multiple data channels can be read at once from /dev/iio:deviceX character device node, thus reducing the CPU load." name="description" />

    <title>Industrial IIO device buffers &#8212; Linux Drivers  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8e8a900e" />
    <link rel="stylesheet" type="text/css" href="../_static/app.min.css?v=5d595293" />
    <script async="async" src="../_static/app.umd.js?v=62fc6850"></script>
    <link rel="icon" href="../_static/icon.svg"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="AD3552R driver" href="ad3552r.html" />
    <link rel="prev" title="Industrial I/O" href="index.html" />
   
  
  
  <meta name="repository" content="linux">
  <meta name="version" content="">
  
    <meta name="page_source_suffix" content=".rst">
  
  
  


<style>
  body {
    
  }

  body.dark {
    
  }

  @media (prefers-color-scheme: dark) {
    body:not(.light) {
      
    }
  }
</style>
  </head>
  
    <body>
  
  <input type="checkbox" id="input-show-toc">
  <input type="checkbox" id="input-show-localtoc">
  <input type="checkbox" id="input-show-repotoc">

  
  <div class="search-area">
    <form action="" method="get">
      <input type="text" name="q" aria-labelledby="search-documentation" value="" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" role="search" placeholder="Search"/>
      <button class="icon"></button>
    </form>
  </div>
  

  <header>
    <div id="left">
      <label id="show-sidebar" class="icon" for="input-show-toc" title="Show/hide index"></label>
    </div>
    <div id="right">
      <span>
        <a id="logo-org" href="https://analog.com" aria-label="Analog Devices Inc. landing page"></a>
        <div class="vertical-divider"></div>
        
        <label id="show-repotoc" for="input-show-repotoc" title="Show/hide docs" tabindex="0">Docs</label>
        
        <a id="logo" href="../index.html">
          <div>Linux</div>
        </a>
      </span>
      <span class="reverse">
        <label id="show-localtoc" class="icon" for="input-show-localtoc" title="Show/hide contents"></label>
      </span>
    </div>
  </header>


  <div class="repotoc-tree overlay">
    <root>
  <a href="../index.html" class="current">Linux</a>
</root>

  </div>
    <div class="localtoc">
      <div class="tocwrapper">
        <div class="header localtoc-header">
          <a id="scroll-up" href="#top-anchor" title="Back to top"></a>
        </div>
        <nav>
          <ul>
<li><a class="reference internal" href="#">Industrial IIO device buffers</a><ul>
<li><a class="reference internal" href="#overview">1. Overview</a></li>
<li><a class="reference internal" href="#buffer-attributes">2. Buffer attributes</a><ul>
<li><a class="reference internal" href="#length"><code class="docutils literal notranslate"><span class="pre">length</span></code></a></li>
<li><a class="reference internal" href="#enable"><code class="docutils literal notranslate"><span class="pre">enable</span></code></a></li>
<li><a class="reference internal" href="#watermark"><code class="docutils literal notranslate"><span class="pre">watermark</span></code></a></li>
<li><a class="reference internal" href="#data-available">Data available</a></li>
<li><a class="reference internal" href="#scan-elements">Scan elements</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </nav>
      </div>
    </div>

  
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
    <a id="no-logo" href="../index.html">
      Linux Drivers
    </a><input id="input-switch-toc" type="checkbox">
<label id="show-repotoc" for="input-switch-toc">
All content
</label>
<label id="show-toc" for="input-switch-toc">
Content on this topic
</label>
<div class="repotoc-tree">
  <root>
  <a href="../index.html" class="current">Linux</a>
</root>

</div>
<div class="toc-tree">
  <html>
  <body><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting Started</a></li>
<li class="toctree-l1 current"><input class="toctree-collapse" type="checkbox" name="toctree-collapse-1" id="toctree-collapse-1" checked=""/><div class="collapse"><a class="reference internal" href="index.html">Industrial I/O</a><label for="toctree-collapse-1"><div class="icon"></div></label></div><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Industrial IIO device buffers</a></li>
<li class="toctree-l2"><a class="reference internal" href="ad3552r.html">AD3552R driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="ad4000.html">AD4000 driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="ad4695.html">AD4695 driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="ad7191.html">AD7191 driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="ad7380.html">AD7380 driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="ad7625.html">AD7625 driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="ad7944.html">AD7944 driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="adis16475.html">ADIS16475 driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="adis16480.html">ADIS16480 driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="adis16550.html">ADIS16550 driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="adxl380.html">ADXL380 driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="apollo.html">AD9088 driver</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../contribute.html">Contribution guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ci.html">Continuous integration</a></li>
</ul>
</body>
</html>

</div>
        </div>
      </div>

  <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper" id="top-anchor">
          <div class="body-header">
  <nav class="breadcrumb"><ol><li><a href="index.html">Industrial I/O</a></li></ol></nav>
</div>
          <div class="body" role="main">
            
  <section id="industrial-iio-device-buffers">
<h1>Industrial IIO device buffers<a class="headerlink" href="#industrial-iio-device-buffers" title="Link to this heading"></a></h1>
<section id="overview">
<h2>1. Overview<a class="headerlink" href="#overview" title="Link to this heading"></a></h2>
<p>The Industrial I/O core offers a way for continuous data capture based on a
trigger source. Multiple data channels can be read at once from
<code class="docutils literal notranslate"><span class="pre">/dev/iio:deviceX</span></code> character device node, thus reducing the CPU load.</p>
<p>Devices with buffer support feature an additional sub-directory in the
<code class="docutils literal notranslate"><span class="pre">/sys/bus/iio/devices/iio:deviceX/</span></code> directory hierarchy, called bufferY, where
Y defaults to 0, for devices with a single buffer.</p>
</section>
<section id="buffer-attributes">
<h2>2. Buffer attributes<a class="headerlink" href="#buffer-attributes" title="Link to this heading"></a></h2>
<p>An IIO buffer has an associated attributes directory under
<code class="docutils literal notranslate"><span class="pre">/sys/bus/iio/iio:deviceX/bufferY/</span></code>. The attributes are described below.</p>
<section id="length">
<h3><code class="docutils literal notranslate"><span class="pre">length</span></code><a class="headerlink" href="#length" title="Link to this heading"></a></h3>
<p>Read / Write attribute which states the total number of data samples (capacity)
that can be stored by the buffer.</p>
</section>
<section id="enable">
<h3><code class="docutils literal notranslate"><span class="pre">enable</span></code><a class="headerlink" href="#enable" title="Link to this heading"></a></h3>
<p>Read / Write attribute which starts / stops the buffer capture. This file should
be written last, after length and selection of scan elements. Writing a non-zero
value may result in an error, such as EINVAL, if, for example, an unsupported
combination of channels is given.</p>
</section>
<section id="watermark">
<h3><code class="docutils literal notranslate"><span class="pre">watermark</span></code><a class="headerlink" href="#watermark" title="Link to this heading"></a></h3>
<p>Read / Write positive integer attribute specifying the maximum number of scan
elements to wait for.</p>
<p>Poll will block until the watermark is reached.</p>
<p>Blocking read will wait until the minimum between the requested read amount or
the low watermark is available.</p>
<p>Non-blocking read will retrieve the available samples from the buffer even if
there are less samples than the watermark level. This allows the application to
block on poll with a timeout and read the available samples after the timeout
expires and thus have a maximum delay guarantee.</p>
</section>
<section id="data-available">
<h3>Data available<a class="headerlink" href="#data-available" title="Link to this heading"></a></h3>
<p>Read-only attribute indicating the bytes of data available in the buffer. In the
case of an output buffer, this indicates the amount of empty space available to
write data to. In the case of an input buffer, this indicates the amount of data
available for reading.</p>
</section>
<section id="scan-elements">
<h3>Scan elements<a class="headerlink" href="#scan-elements" title="Link to this heading"></a></h3>
<p>The meta information associated with a channel data placed in a buffer is called
a scan element. The scan elements attributes are presented below.</p>
<p><strong>_en</strong></p>
<p>Read / Write attribute used for enabling a channel. If and only if its value
is non-zero, then a triggered capture will contain data samples for this
channel.</p>
<p><strong>_index</strong></p>
<p>Read-only unsigned integer attribute specifying the position of the channel in
the buffer. Note these are not dependent on what is enabled and may not be
contiguous. Thus for userspace to establish the full layout these must be used
in conjunction with all _en attributes to establish which channels are present,
and the relevant _type attributes to establish the data storage format.</p>
<p><strong>_type</strong></p>
<p>Read-only attribute containing the description of the scan element data storage
within the buffer and hence the form in which it is read from userspace. Format
is [be|le]:[s|u]bits/storagebits[Xrepeat][&gt;&gt;shift], where:</p>
<ul class="simple">
<li><p><strong>be</strong> or <strong>le</strong> specifies big or little-endian.</p></li>
<li><p><strong>s</strong> or <strong>u</strong> specifies if signed (2â€™s complement) or unsigned.</p></li>
<li><p><strong>bits</strong> is the number of valid data bits.</p></li>
<li><p><strong>storagebits</strong> is the number of bits (after padding) that it occupies in the
buffer.</p></li>
<li><p><strong>repeat</strong> specifies the number of bits/storagebits repetitions. When the
repeat element is 0 or 1, then the repeat value is omitted.</p></li>
<li><p><strong>shift</strong> if specified, is the shift that needs to be applied prior to
masking out unused bits.</p></li>
</ul>
<p>For example, a driver for a 3-axis accelerometer with 12-bit resolution where
data is stored in two 8-bit registers is as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="mi">7</span>   <span class="mi">6</span>   <span class="mi">5</span>   <span class="mi">4</span>   <span class="mi">3</span>   <span class="mi">2</span>   <span class="mi">1</span>   <span class="mi">0</span>
<span class="o">+---+---+---+---+---+---+---+---+</span>
<span class="o">|</span><span class="n">D3</span> <span class="o">|</span><span class="n">D2</span> <span class="o">|</span><span class="n">D1</span> <span class="o">|</span><span class="n">D0</span> <span class="o">|</span> <span class="n">X</span> <span class="o">|</span> <span class="n">X</span> <span class="o">|</span> <span class="n">X</span> <span class="o">|</span> <span class="n">X</span> <span class="o">|</span> <span class="p">(</span><span class="n">LOW</span> <span class="n">byte</span><span class="p">,</span> <span class="n">address</span> <span class="mh">0x06</span><span class="p">)</span>
<span class="o">+---+---+---+---+---+---+---+---+</span>

  <span class="mi">7</span>   <span class="mi">6</span>   <span class="mi">5</span>   <span class="mi">4</span>   <span class="mi">3</span>   <span class="mi">2</span>   <span class="mi">1</span>   <span class="mi">0</span>
<span class="o">+---+---+---+---+---+---+---+---+</span>
<span class="o">|</span><span class="n">D11</span><span class="o">|</span><span class="n">D10</span><span class="o">|</span><span class="n">D9</span> <span class="o">|</span><span class="n">D8</span> <span class="o">|</span><span class="n">D7</span> <span class="o">|</span><span class="n">D6</span> <span class="o">|</span><span class="n">D5</span> <span class="o">|</span><span class="n">D4</span> <span class="o">|</span> <span class="p">(</span><span class="n">HIGH</span> <span class="n">byte</span><span class="p">,</span> <span class="n">address</span> <span class="mh">0x07</span><span class="p">)</span>
<span class="o">+---+---+---+---+---+---+---+---+</span>
</pre></div>
</div>
<p>will have the following scan element type for each axis:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>cat<span class="w"> </span>/sys/bus/iio/devices/iio:device0/buffer0/in_accel_y_type
le:s12/16&gt;&gt;4
</pre></div>
</div>
<p>A userspace application will interpret data samples read from the buffer as
two-byte little-endian signed data, that needs a 4 bits right shift before
masking out the 12 valid bits of data.</p>
<p>It is also worth mentioning that the data in the buffer will be naturally
aligned, so the userspace application has to handle the buffers accordingly.</p>
<p>Take for example, a driver with four channels with the following description:
- channel0: index: 0, type: be:u16/16&gt;&gt;0
- channel1: index: 1, type: be:u32/32&gt;&gt;0
- channel2: index: 2, type: be:u32/32&gt;&gt;0
- channel3: index: 3, type: be:u64/64&gt;&gt;0</p>
<p>If all channels are enabled, the data will be aligned in the buffer as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="mi">0</span><span class="o">-</span><span class="mi">1</span>   <span class="mi">2</span>   <span class="mi">3</span>   <span class="mi">4</span><span class="o">-</span><span class="mi">7</span>  <span class="mi">8</span><span class="o">-</span><span class="mi">11</span>  <span class="mi">12</span>  <span class="mi">13</span>  <span class="mi">14</span>  <span class="mi">15</span>  <span class="mi">16</span><span class="o">-</span><span class="mi">23</span>   <span class="o">-&gt;</span> <span class="n">buffer</span> <span class="n">byte</span> <span class="n">number</span>
<span class="o">+-----+---+---+-----+-----+---+---+---+---+-----+</span>
<span class="o">|</span><span class="n">CHN_0</span><span class="o">|</span><span class="n">PAD</span><span class="o">|</span><span class="n">PAD</span><span class="o">|</span><span class="n">CHN_1</span><span class="o">|</span><span class="n">CHN_2</span><span class="o">|</span><span class="n">PAD</span><span class="o">|</span><span class="n">PAD</span><span class="o">|</span><span class="n">PAD</span><span class="o">|</span><span class="n">PAD</span><span class="o">|</span><span class="n">CHN_3</span><span class="o">|</span>  <span class="o">-&gt;</span> <span class="n">buffer</span> <span class="n">content</span>
<span class="o">+-----+---+---+-----+-----+---+---+---+---+-----+</span>
</pre></div>
</div>
<p>If only channel0 and channel3 are enabled, the data will be aligned in the
buffer as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="mi">0</span><span class="o">-</span><span class="mi">1</span>   <span class="mi">2</span>   <span class="mi">3</span>   <span class="mi">4</span>   <span class="mi">5</span>   <span class="mi">6</span>   <span class="mi">7</span>  <span class="mi">8</span><span class="o">-</span><span class="mi">15</span>    <span class="o">-&gt;</span> <span class="n">buffer</span> <span class="n">byte</span> <span class="n">number</span>
<span class="o">+-----+---+---+---+---+---+---+-----+</span>
<span class="o">|</span><span class="n">CHN_0</span><span class="o">|</span><span class="n">PAD</span><span class="o">|</span><span class="n">PAD</span><span class="o">|</span><span class="n">PAD</span><span class="o">|</span><span class="n">PAD</span><span class="o">|</span><span class="n">PAD</span><span class="o">|</span><span class="n">PAD</span><span class="o">|</span><span class="n">CHN_3</span><span class="o">|</span>  <span class="o">-&gt;</span> <span class="n">buffer</span> <span class="n">content</span>
<span class="o">+-----+---+---+---+---+---+---+-----+</span>
</pre></div>
</div>
<p>Typically the buffered data is found in raw format (unscaled with no offset
applied), however there are corner cases in which the buffered data may be found
in a processed form. Please note that these corner cases are not addressed by
this documentation.</p>
<p>Please see <code class="docutils literal notranslate"><span class="pre">Documentation/ABI/testing/sysfs-bus-iio</span></code> for a complete
description of the attributes.</p>
</section>
</section>
</section>


          </div>
              <div class="related">
                &nbsp;
    <a href="index.html" title="Previous document (Alt+Shift+LeftArrow)" class="prev">Industrial I/O</a>
    <a href="ad3552r.html" title="Next document (Alt+Shift+RightArrow)" class="next">AD3552R driver</a>
              </div>
          
        </div>
      </div>
  </div>

  <label id="cancel-area-show-toc" for="input-show-toc"></label>
  <label id="cancel-area-show-localtoc" for="input-show-localtoc"></label>
    <footer>
      &#169;2025, Analog Devices, Inc.
      
      |
      Made with <a href="https://www.sphinx-doc.org/">Sphinx</a>
      &amp; <a href="https://github.com/analogdevicesinc/doctools">Doctools</a>
      
    </footer>
  </body>
</html>