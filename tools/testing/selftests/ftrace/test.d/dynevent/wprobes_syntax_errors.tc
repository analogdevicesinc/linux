#!/bin/sh
# SPDX-License-Identifier: GPL-2.0
# description: Watch probe event parser error log check
# requires: dynamic_events "w[:[<group>/][<event>]] [r|w|rw]@<addr>[:<len>]":README

check_error() { # command-with-error-pos-by-^
    ftrace_errlog_check 'wprobe' "$1" 'dynamic_events'
}

check_error 'w ^symbol'			# BAD_ACCESS_FMT
check_error 'w ^a@symbol'		# BAD_ACCESS_TYPE
check_error 'w w@^symbol'		# BAD_ACCESS_ADDR
check_error 'w w@jiffies^+offset'	# BAD_ACCESS_ADDR
check_error 'w w@jiffies:^100'		# BAD_ACCESS_LEN
check_error 'w w@jiffies ^$arg1'	# BAD_VAR
check_error 'w w@jiffies ^$retval'	# BAD_VAR
check_error 'w w@jiffies ^$stack'	# BAD_VAR
check_error 'w w@jiffies ^%ax'		# BAD_VAR

exit 0
